name: Automation Self-Check

on:
  workflow_dispatch:
  schedule:
    - cron: "0 9 * * 1"  # Every Monday at 09:00 UTC

jobs:
  self-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repo
        uses: actions/checkout@v4

      - name: List workflows
        run: |
          echo "Existing workflows:"
          ls -R .github/workflows || echo "No workflows directory found."

      - name: Validate workflow syntax
        uses: actions/github-script@v7
        with:
          script: |
            const workflows = await github.request('GET /repos/{owner}/{repo}/actions/workflows', {
              owner: context.repo.owner,
              repo: context.repo.repo
            });
            core.info(`Found ${workflows.data.workflows.length} workflows.`);
            for (const wf of workflows.data.workflows) {
              core.info(`- ${wf.name} (${wf.id}) state=${wf.state}`);
            }
